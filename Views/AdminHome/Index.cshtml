@*@{
        ViewData["Title"] = "Index";
    }

    <h1>Index</h1>*@

@model IEnumerable<Private_Note.Areas.Identity.Data.ApplicationUser>

<div class="container p-3">
    <div class="col-6">
        <h2 class="text-primary">User List</h2>
    </div>
    @*<div class="col-6 text-right">
            <a asp-controller="AdminHome" asp-action="DeleteUser" class="btn btn-primary">
                Delete User
            </a>
        </div>*@
    <form id="DeleteUser">
        <div class="row">
            <div class="form-group">
                <div class="col-md-10">
                    <p>Delete User</p>
                    <input id="userName" name="userName" type="text" placeholder="User Name" />
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-10">
                <input class="btn btn-success" type="submit" value="Delete" />
            </div>
        </div>
    </form>
    <form id="ChangeSecretPasswordForm" >
        <div class="row">
            <div class="form-group">
                <div class="col-md-10">
                    <p>Change Secret Password</p>
                    <input id="userName" name="userName" type="text" placeholder="User Name" />
                </div>
                <div class="col-md-10">
                    <input id="secretPassword" name="secretPassword" type="text" placeholder="Secret Password" />
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-10">
                <input class="btn btn-success" type="submit" value="Change Secret Password" />
            </div>
        </div>
    </form>
    <form id="ContactUser">
        <div class="row">
            <div class="form-group">
                <div class="col-md-10">
                    <p>Contact User</p>
                    <input id="userType" name="userType" type="text" placeholder="U(User) A(Admin)" />
                    <input id="userName" name="userName" type="text" placeholder="User Name" />
                </div>
                <div class="col-md-10">
                    <input id="subject" name="subject" type="text" placeholder="subject" />
                </div>
                <div class="col-md-10">
                    <textarea id="content" name="content" type="text" rows="20" cols="50" placeholder="content"></textarea>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-10">
                <input class="btn btn-success" type="submit" value="Contact User" />
            </div>
        </div>
    </form>
    <div class="col-6 text-right">
        <a href='/Identity/Account/AdminRegister' class="btn btn-primary">
            Add Admin
        </a>
    </div>
    <br /><br />

    @if (Model.Count() > 0)
    {
        <table class="table table-bordered table-striped" style="width: 100%">
            <thead>
                <tr>
                    <th>
                        User Name
                    </th>
                    <th>
                        Password
                    </th>
                    <th>
                        Secret Password
                    </th>
                    <th>
                        Email Address
                    </th>
                    <th>
                        Is Admin
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var obj in Model)
                {
                    <tr>
                        <td width="40%">@obj.UserName</td>
                        <td width="40%">@obj.Password</td>
                        <td width="50%">@obj.SecretPassword</td>
                        <td width="40%">@obj.Email</td>
                        <td width="20%">@obj.IsAdmin</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p>No User exist</p>
    }
</div>

@section Scripts{
    <script>
        $("#DeleteUser").submit(function (e) {
            e.preventDefault();
            const userName = $("#userName").val();
            $.ajax({
                type: "POST",
                url: "/AdminHome/DeleteUser",
                data: {
                    "userName": userName
                },
                success: function (data) {
                    //console.log(data);
                    toastr.success("User Successfully Removed");
                    $("#userName").val("");
                },
                error: function (data) {
                    toastr.error("User Unsuccessfully Removed");
                    //console.log(data);
                }
            });
        });
        $("#ChangeSecretPasswordForm").submit(function (e){
            e.preventDefault();
            const userName = $("#userName").val();
            const secretPassword = $("#secretPassword").val();
            $.ajax({
                type: "POST",
                url: "/AdminHome/ChangeSecretPassword",
                data: {
                    "userName": userName,
                    "secretPassword": secretPassword
                },
                success: function (data) {
                    //console.log(data);
                    toastr.success("User's Secret Password Successfully Changed");
                    $("#secretPassword").val("");
                    $("#userName").val("");
                },
                error: function (data) {
                    toastr.error("User's Secret Password Unsuccessfully Changed");
                    //console.log(data);
                }
            });
        });
        $("#ContactUser").submit(function (e) {
            e.preventDefault();
            const userType = $("#userType").val();
            const userName = $("#userName").val();
            const subject = $("#subject").val();
            const content = $("#content").val();
            $.ajax({
                type: "POST",
                url: "/AdminHome/ContactUser",
                data: {
                    "userType": userType,
                    "userName": userName,
                    "subject": subject,
                    "content": content
                },
                success: function (data) {
                    //console.log(data);
                    toastr.success("Email Successfully Sent");
                    $("#userType").val("");
                    $("#userName").val("");
                    $("#subject").val("");
                    $("#content").val("");
                },
                error: function (data) {
                    toastr.error("Email Unsuccessfully Sent");
                    //console.log(data);
                }
            });
        });
    </script>
}